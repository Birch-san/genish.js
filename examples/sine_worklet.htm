<!doctype html>
<html lang=en>
  <head>
    <meta charset='utf-8'>
    <script src='../dist/gen.lib.js'></script>
  <meta http-equiv="origin-trial" data-feature="AudioWorklet" data-expires="2018-03-06" content="Al1KANuVLbIk5hLbRXsa1k3bLvSuCaQn/2/3HlZIJPkwLlbzglGg8Cg96npoqaDaNHunPRHSqTijdeMurQV8GQQAAABQeyJvcmlnaW4iOiJodHRwOi8vMTI3LjAuMC4xOjEwMDAwIiwiZmVhdHVyZSI6IkF1ZGlvV29ya2xldCIsImV4cGlyeSI6MTUyMDI5NDQwMH0=">
  </head>
  <body>
    <p> click in the window please. </p>
  </body>
  <script>

    const click = function() {
      genish.export( window )

      // context will be stored in utilities.ctx
      utilities.createContext()

      const ctx = utilities.ctx

      const sine = ctx.createOscillator()
      sine.frequency.value = 2

      const gain  = ctx.createGain()
      gain.gain.value = 40

      sine.connect( gain )

      utilities.playWorklet( cycle( add( 220, input('freqMod', 0, 0 ) ) ) ).then( node => {
        gain.connect( node )
        node.connect( ctx.destination )
        sine.start()
      })

      window.removeEventListener( 'click', click )
    }

    window.onload = ()=> window.addEventListener( 'click', click )
  </script>

</html>



